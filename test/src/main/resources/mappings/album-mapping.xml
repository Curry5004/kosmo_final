<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="AlbumDAO">



<insert id="insertAlbum" parameterType="album">
	INSERT INTO ALBUM(PARTY_ID,ALB_WRITER,ALB_IMG_PATH,
	ALB_REG_DATE) 
	VALUES(${party_id},#{alb_writer},#{alb_img_path},#{alb_reg_date})
</insert>

<select id="getAlbumCnt" resultType="int">
	SELECT COUNT(*) FROM ALBUM WHERE PARTY_ID=#{party_id} AND ALB_AVAILABLE=TRUE;
</select>

<select id="getAlbumList" resultType="album">
	SELECT A.ALB_ID, A.PARTY_ID, USER_ID, A.ALB_WRITER, ALB_IMG_PATH,ALB_REG_DATE,ALB_AVAILABLE, COUNT(USER_ID) as likeCnt FROM ALBUM a left outer join like_list l
	on a.alb_id=l.ALBUM_ID
	WHERE ALB_AVAILABLE=TRUE AND a.PARTY_ID=#{party_id}
    group by ALBUM_ID
	ORDER BY ALB_ID DESC
	LIMIT #{listSize} OFFSET #{startRow}
</select>
</mapper>