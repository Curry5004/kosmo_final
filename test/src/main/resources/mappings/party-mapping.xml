<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="PartyDAO">

<select id ="getPartyList" resultType="party" parameterType="java.util.HashMap">
	SELECT * FROM PARTY 
	WHERE
		1=1
	AND PARTY_AVAILABLE = TRUE
	<if test="!@org.springframework.util.ObjectUtils@isEmpty(CATEGORY_NAME)">
		AND CATEGORY_NAME = #{CATEGORY_NAME}
	</if>
	<if test="!@org.springframework.util.ObjectUtils@isEmpty(SEARCH_KEYWORD)">
		AND PARTY_TITLE LIKE CONCAT('%',#{SEARCH_KEYWORD},'%') 
	</if>
	<if test="!@org.springframework.util.ObjectUtils@isEmpty(START_ROW) and !@org.springframework.util.ObjectUtils@isEmpty(LIST_SIZE)">
		LIMIT #{LIST_SIZE} OFFSET #{START_ROW}
	</if>
</select>

<select id = "getPartyCnt" resultType="int" parameterType="java.util.HashMap">
	select count(*) from party
	WHERE
	 	1=1
	 AND PARTY_AVAILABLE = TRUE
	<if test="!@org.springframework.util.ObjectUtils@isEmpty(CATEGORY_NAME)">
		AND CATEGORY_NAME = #{CATEGORY_NAME}
	</if>
	<if test="!@org.springframework.util.ObjectUtils@isEmpty(SEARCH_KEYWORD)">
		AND PARTY_TITLE LIKE CONCAT('%',#{SEARCH_KEYWORD},'%')
	</if>
</select>

</mapper>